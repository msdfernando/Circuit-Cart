<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Circuit Cart Dashboard</title>
  <link rel="stylesheet" href="styles/styles.css">
</head>
<body>
  <!-- Main Dashboard -->
  <div id="dashboard">
    <header>
      <img src="assets/logo.png" alt="Logo" class="logo">
    </header>

    <main>
      <!-- Left Section: Camera Feed and Label Feed -->
      <div class="left-section">
        <div>
          <h2>Camera Feed</h2>
          <img id="camera-image" src="" alt="Camera Feed">
        </div>
        <div>
          <h2>Label Feed</h2>
          <div id="label-data">
            <p>Loading label data...</p>
          </div>
        </div>
      </div>

      <!-- Right Section: Cart List -->
      <div class="right-section">
        <h2>Cart List</h2>
        <div id="cart-list">
          <!-- Cart items will be dynamically added here -->
        </div>
        <div id="total-amount">
          <p>Total: $<span id="total-value">0.00</span></p>
        </div>
        <div class="buttons">
          <button id="pay-button">PAY</button>
          <button id="cancel-button">CANCEL</button>
        </div>
      </div>
    </main>

    <footer>
      <p>Powered by Circuit Cart</p>
    </footer>
  </div>

  <!-- Bill/Receipt Page -->
  <div id="bill-page" class="hidden">
    <header>
      <h1>ðŸŽ‰ Payment Successful! ðŸŽ‰</h1>
      <button id="back-to-dashboard">Back to Home</button>
    </header>

    <main>
      <div class="bill-container">
        <!-- Left Side: Bill Details -->
        <div class="bill-details">
          <h2>Your Bill</h2>
          <div id="bill-items">
            <!-- Bill items will be dynamically added here -->
          </div>
          <div id="bill-total">
            <p>Total: $<span id="bill-total-value">0.00</span></p>
          </div>
        </div>

        <!-- Right Side: Number Pad and Mobile Number Input -->
        <div class="number-pad-section">
          <div>
            <input type="text" id="phone-number" placeholder="Enter phone number" readonly />
          </div>
          <div class="number-pad">
            <button class="num-btn" data-number="1">1</button>
            <button class="num-btn" data-number="2">2</button>
            <button class="num-btn" data-number="3">3</button>
            <button class="num-btn" data-number="4">4</button>
            <button class="num-btn" data-number="5">5</button>
            <button class="num-btn" data-number="6">6</button>
            <button class="num-btn" data-number="7">7</button>
            <button class="num-btn" data-number="8">8</button>
            <button class="num-btn" data-number="9">9</button>
            <button class="num-btn" data-number="0">0</button>
            <button id="clear-btn">C</button>
            <button id="send-btn">Send</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="module">
    // Import your functions from main.js
    import { 
      appendNumber, 
      clearNumber, 
      sendBillViaSMS, 
      goBackToDashboard,
      fetchData,
      FEEDS,
      handlePayment
    } from './scripts/main.js';

    // Event listeners for number pad
    document.querySelectorAll('.num-btn').forEach(btn => {
      btn.addEventListener('click', () => appendNumber(btn.dataset.number));
    });

    document.getElementById('clear-btn').addEventListener('click', clearNumber);
    document.getElementById('send-btn').addEventListener('click', sendBillViaSMS);
    
    // Other buttons
    document.getElementById('back-to-dashboard').addEventListener('click', goBackToDashboard);
    document.getElementById('pay-button').addEventListener('click', handlePayment);
    document.getElementById('cancel-button').addEventListener('click', () => {
      cart = [];
      updateCartList();
      updateTotalAmount();
    });

    // Initial fetch
    fetchData(FEEDS.CAMERA, "camera-image");
    fetchData(FEEDS.LABEL, "label-data");
    setInterval(() => {
      fetchData(FEEDS.CAMERA, "camera-image"); 
      fetchData(FEEDS.LABEL, "label-data");    
    }, 5000);
  </script>
</body>
</html>